<!doctype html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>فرم انتخاب فیچرها — دستیار هوش مصنوعی</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-feature-settings: "ss01";
        }

        .number {
            font-variant-numeric: tabular-nums;
        }

        /* No rounded corners anywhere */
        * {
            border-radius: 0 !important;
        }
    </style>
</head>

<body class="bg-white text-slate-900">
    <!-- Header -->
    <header class="bg-slate-900 text-white">
        <div class="max-w-6xl mx-auto p-4">
            <h1 class="text-xl font-semibold">فرم انتخاب فیچرها — ربات هوشمند پشتیبانی</h1>
            <p class="text-sm text-slate-300 mt-1">لطفاً قابلیت‌های موردنیاز را تیک بزنید. مجموع زمان و هزینه به‌صورت
                خودکار محاسبه می‌شود.</p>
        </div>
    </header>

    <!-- Summary Bar -->
    <section class="bg-slate-100 border-b border-slate-300">
        <div class="max-w-6xl mx-auto p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="p-3 bg-white border border-slate-300">
                <div class="text-sm text-slate-600">مجموع فاندیشن</div>
                <div class="mt-1 number"><span id="foundationDays" class="font-semibold">0</span> روز | <span
                        id="foundationCost" class="font-semibold">0</span> میلیون تومان</div>
            </div>
            <div class="p-3 bg-white border border-slate-300">
                <div class="text-sm text-slate-600">آپشنال انتخاب‌شده</div>
                <div class="mt-1 number"><span id="optionalDays" class="font-semibold">0</span> روز | <span
                        id="optionalCost" class="font-semibold">0</span> میلیون تومان</div>
            </div>
            <div class="p-3 bg-white border border-slate-300">
                <div class="text-sm text-slate-600">جمع کل</div>
                <div class="mt-1 number text-lg"><span id="totalDays" class="font-bold">0</span> روز | <span
                        id="totalCost" class="font-bold">0</span> میلیون تومان</div>
            </div>
            <button id="btnCheckAll" class="px-3 py-2 text-sm bg-slate-900 text-white border border-slate-900">
                انتخاب همه آپشنال‌ها
            </button>
        </div>

    </section>


    <main class="max-w-6xl mx-auto p-4 space-y-6" id="mainContent">
        <!-- Content will be generated by JavaScript -->
    </main>
    <div class="max-w-6xl mx-auto p-4 space-y-6" id="mainContent" dir="rtl">
        <div class="p-4 bg-yellow-50 border border-yellow-300 rounded text-yellow-800">
            <div class="text-sm font-semibold">توجه</div>
            <div class="mt-1 text-sm">
                قیمت‌های نمایش‌داده‌شده تنها شامل هزینه‌های توسعه و برنامه‌نویسی می‌باشند.
                هزینه‌های مربوط به سرور، خدمات میزبانی، دامنه و ارائه‌دهندگان AI (مثل سرویس‌های ChatGPT) در این ارقام
                منظور
                نشده‌اند.
                برای استفاده از مدل های اوپن سورس داخلی هزینه سخت افزاری حدود 600 هزار دلار براورد میشود
            </div>
        </div>
    </div>
    <footer class="bg-slate-900 text-white mt-8">
        <div class="max-w-6xl mx-auto p-4 text-xs text-slate-300">
            © پروپوزال دستیار هوشمند پشتیبانی، 2025
        </div>
    </footer>

    <script>
        // JSON Data Structure
        const featuresData = {
            sections: [
                {
                    id: "foundation",
                    title: "فیچرهای فاندیشن (اجباری)",
                    description:
                        "این موارد برای کارکرد صحیح کل سیستم (چت، تلفن، رزرو ویزیت) ضروری‌اند. به‌صورت پیش‌فرض انتخاب و غیرقابل تغییر هستند.",
                    items: [
                        {
                            id: "f-llm",
                            name: "هسته گفت‌وگو (LLM Core) — مدیریت کانتکست و تولید پاسخ",
                            days: 10,
                            cost: 32,
                            required: true
                        },
                        {
                            id: "f-vector",
                            name: "جستجوی معنایی و RAG (Vector Search)",
                            days: 8,
                            cost: 25,
                            required: true
                        },
                        {
                            id: "f-kb",
                            name: "مدیریت پایگاه دانش (Knowledge Base Manager)",
                            days: 7,
                            cost: 23,
                            required: true
                        },
                        {
                            id: "f-db",
                            name: "پایگاه داده مرکزی و ORM (مریض‌ها، رزروها، لاگ تماس‌ها)",
                            days: 6,
                            cost: 15,
                            required: true
                        },
                        {
                            id: "f-admin-basic",
                            name: "پنل ادمین پایه (مشاهده مکالمات، لاگ تماس‌های ورودی، مدیریت رزروها)",
                            days: 10,
                            cost: 32,
                            required: true
                        },
                        {
                            id: "f-security",
                            name: "امنیت و رمزنگاری داده و ارتباطات (PHI / اطلاعات بیمار)",
                            days: 4,
                            cost: 9,
                            required: true
                        },
                        {
                            id: "f-deploy",
                            name: "دیپلوی و CI/CD",
                            days: 5,
                            cost: 13,
                            required: true
                        },
                        {
                            id: "f-logs",
                            name: "مانیتورینگ و لاگ (گفتگو، تماس، رزرو)",
                            days: 4,
                            cost: 9,
                            required: true
                        }
                    ]
                },

                {
                    id: "telephony",
                    title: "📞 منشی تلفنی هوشمند (AI Receptionist)",
                    description:
                        "ربات جوابگو روی خط تلفن مطب/کلینیک. تماس‌گیرنده زنگ می‌زند، ای‌آی پاسخ می‌دهد، اطلاعات می‌گیرد و نوبت رزرو می‌کند.",
                    items: [
                        {
                            id: "tel-sip-gateway",
                            name: "اتصال تلفن/VoIP/SIP به سیستم (ورود تماس واقعی از خط مطب)",
                            days: 10,
                            cost: 28,
                            required: false
                        },
                        {
                            id: "tel-live-answer",
                            name: "پاسخ‌دهنده خودکار (IVR مکالمه‌محور، نه فقط دکمه‌های ۱ و ۲)",
                            days: 7,
                            cost: 20,
                            required: false
                        },
                        {
                            id: "tel-call-transcript",
                            name: "تشخیص گفتار لحظه‌ای تماس‌گیرنده (Speech-to-Text در تماس تلفنی)",
                            days: 5,
                            cost: 13,
                            required: false
                        },
                        {
                            id: "tel-voice-synthesis",
                            name: "صدا‌ی خروجی طبیعی (Text-to-Speech تلفنی)",
                            days: 5,
                            cost: 13,
                            required: false
                        },
                        {
                            id: "tel-caller-profile",
                            name: "گرفتن اطلاعات تماس‌گیرنده (نام، شماره تماس، علت مراجعه) و ساخت/آپدیت پرونده بیمار",
                            days: 4,
                            cost: 11,
                            required: false
                        },
                        {
                            id: "tel-human-escalation",
                            name: "امکان وصل‌کردن تماس به منشی انسانی در لحظه",
                            days: 6,
                            cost: 15,
                            required: false
                        }
                    ]
                },

                {
                    id: "scheduling",
                    title: "📅 رزرو ویزیت و مدیریت نوبت‌ها",
                    description:
                        "مغز منشی: پیدا کردن زمان خالی دکتر، رزرو، ارسال تأییدیه و مدیریت تغییر/کنسلی.",
                    items: [
                        {
                            id: "sched-calendar-core",
                            name: "موتور تقویم و اسلات خالی دکترها (Availability Engine)",
                            days: 10,
                            cost: 28,
                            required: false
                        },
                        {
                            id: "sched-book-visit",
                            name: "ثبت ویزیت از طریق صدا/تلفن یا چت (Create Appointment)",
                            days: 8,
                            cost: 23,
                            required: false
                        },
                        {
                            id: "sched-patient-confirm",
                            name: "ارسال تأییدیه نوبت و یادآوری (SMS / تلگرام)",
                            days: 5,
                            cost: 12,
                            required: false
                        },
                        {
                            id: "sched-reschedule-cancel",
                            name: "کنسل یا جابجا کردن وقت توسط بیمار (خودکار)",
                            days: 6,
                            cost: 16,
                            required: false
                        },
                        {
                            id: "sched-admin-dashboard",
                            name: "داشبورد ادمین برای دیدن و ویرایش نوبت‌ها",
                            days: 6,
                            cost: 16,
                            required: false
                        }
                    ]
                },

                {
                    id: "channels",
                    title: "💬 کانال‌ها و تعامل",
                    description:
                        "راه‌های دیگه برای صحبت با دستیار (غیر از تلفن).",
                    items: [
                        {
                            id: "opt-webchat",
                            name: "وب‌چت سایت (Widget)",
                            days: 8,
                            cost: 23,
                            required: false
                        },
                        {
                            id: "opt-telegram-bot",
                            name: "ربات تلگرام (چت با منشی)",
                            days: 6,
                            cost: 18,
                            required: false
                        },
                        {
                            id: "opt-telegram-notif",
                            name: "اعلان به منشی/پشتیبان در تلگرام (وقتی مورد حساس ثبت شد)",
                            days: 3,
                            cost: 9,
                            required: false
                        },
                        {
                            id: "opt-voice-in",
                            name: "ویس ورودی (Speech-to-Text) در چت یا ویس‌مسج",
                            days: 5,
                            cost: 13,
                            required: false
                        },
                        {
                            id: "opt-voice-out",
                            name: "ویس خروجی (Text-to-Speech) برای جواب صوتی داخل تلگرام/وب",
                            days: 5,
                            cost: 13,
                            required: false
                        }
                    ]
                },

                {
                    id: "human-support",
                    title: "👥 پشتیبانی انسانی و مدیریت",
                    description:
                        "وقتی ای‌آی کافی نیست یا باید تأیید انسانی وجود داشته باشد.",
                    items: [
                        {
                            id: "opt-handoff",
                            name: "انتقال به اپراتور انسانی (چت یا تلفن)",
                            days: 6,
                            cost: 15,
                            required: false
                        },
                        {
                            id: "opt-sla",
                            name: "اولویت‌دهی و مارک‌کردن تیکت‌ها / بیماران حساس",
                            days: 4,
                            cost: 10,
                            required: false
                        },
                        {
                            id: "opt-rbac",
                            name: "نقش‌ها و دسترسی اپراتوری (دکتر، منشی، ادمین)",
                            days: 6,
                            cost: 15,
                            required: false
                        }
                    ]
                },

                {
                    id: "analytics",
                    title: "📊 گزارش و تحلیل",
                    description:
                        "دیدن راندمان منشی هوش مصنوعی و کیفیت سرویس.",
                    items: [
                        {
                            id: "opt-anal-convcount",
                            name: "داشبورد حجم تماس و مکالمه (چند تا زنگ خورد، چند تا جواب داده شد)",
                            days: 3,
                            cost: 7,
                            required: false
                        },
                        {
                            id: "opt-anal-csat",
                            name: "ثبت و اندازه‌گیری رضایت بیمار بعد از تماس یا رزرو",
                            days: 3,
                            cost: 7,
                            required: false
                        },
                        {
                            id: "opt-anal-faq",
                            name: "استخراج سوالات پرتکرار (بیشترین علت تماس)",
                            days: 4,
                            cost: 10,
                            required: false
                        },
                        {
                            id: "opt-anal-sentiment",
                            name: "تحلیل احساسات مکالمات (عصبانی/نگران/اورژانسی)",
                            days: 4,
                            cost: 10,
                            required: false
                        },
                        {
                            id: "opt-anal-perf",
                            name: "داشبورد عملکرد منشی ای‌آی (میانگین زمان پاسخ، درصد رزرو موفق)",
                            days: 4,
                            cost: 10,
                            required: false
                        }
                    ]
                },

                {
                    id: "data-hosting",
                    title: "🔒 داده و میزبانی",
                    description:
                        "پایداری و انطباق؛ مخصوص حوزه پزشکی خیلی مهمه.",
                    items: [
                        {
                            id: "opt-backup",
                            name: "بکاپ‌گیری و بازیابی (پایگاه داده بیماران و رزروها)",
                            days: 3,
                            cost: 7,
                            required: false
                        }
                    ]
                },

                {
                    id: "integrations",
                    title: "🧩 یکپارچه‌سازی‌ها",
                    description:
                        "اتصال به سیستم‌های خارجی که کلینیک/سازمان ممکنه از قبل داشته باشه.",
                    items: [
                        {
                            id: "opt-dao",
                            name: "اتصال به DAO / سیستم‌های داخلی سازمان برای استعلام دیتا",
                            days: 8,
                            cost: 25,
                            required: false
                        },
                        {
                            id: "opt-api-extensions",
                            name: "API Global (وب‌هوک و API برای اتصال به CRM/EMR/تقویم دکتر)",
                            days: 4,
                            cost: 10,
                            required: false
                        }
                    ]
                }
            ]
        };

        // Render Functions
        function renderSections() {
            const mainContent = document.getElementById('mainContent');
            let html = '';

            featuresData.sections.forEach(section => {
                html += `
          <section class="border border-slate-300 bg-white">
            <div class="p-3 bg-slate-100 border-b border-slate-300">
              <h2 class="text-lg font-semibold">${section.title}</h2>
              ${section.description ? `<p class="text-sm text-slate-600 mt-1">${section.description}</p>` : ''}
            </div>
            <div class="p-4 space-y-3">
        `;

                section.items.forEach(item => {
                    const isFoundation = item.required;
                    const checkboxClass = isFoundation ? 'foundation' : 'feature';
                    const checkedAttr = isFoundation ? 'checked' : '';
                    const disabledAttr = isFoundation ? 'disabled' : '';

                    html += `
            <label class="flex items-center justify-between p-3 border border-slate-200 bg-white">
              <div class="flex items-center gap-2">
                <input type="checkbox" 
                  class="${checkboxClass} h-5 w-5" 
                  ${checkedAttr} 
                  ${disabledAttr} 
                  data-id="${item.id}" 
                  data-days="${item.days}" 
                  data-cost="${item.cost}">
                <span>${item.name}</span>
              </div>
              <div class="text-sm number text-slate-700">${item.days} روز | ${item.cost} میلیون</div>
            </label>
          `;
                });

                html += `
            </div>
          </section>
        `;
            });





            html += `
          </div>
        </section>
      `;

            mainContent.innerHTML = html;
        }

        // Calculation Functions
        function toInt(v) { return parseInt(v, 10) || 0; }

        function calcTotals() {
            const foundation = Array.from(document.querySelectorAll('input.foundation'));
            const optional = Array.from(document.querySelectorAll('input.feature'));

            let fDays = 0, fCost = 0;
            foundation.forEach(cb => {
                fDays += toInt(cb.dataset.days);
                fCost += toInt(cb.dataset.cost);
            });

            let oDays = 0, oCost = 0;
            optional.filter(cb => cb.checked).forEach(cb => {
                oDays += toInt(cb.dataset.days);
                oCost += toInt(cb.dataset.cost);
            });

            document.getElementById('foundationDays').textContent = fDays;
            document.getElementById('foundationCost').textContent = fCost;
            document.getElementById('optionalDays').textContent = oDays;
            document.getElementById('optionalCost').textContent = oCost;
            document.getElementById('totalDays').textContent = fDays + oDays;
            document.getElementById('totalCost').textContent = fCost + oCost;
        }

        function buildJSON() {
            const foundation = Array.from(document.querySelectorAll('input.foundation'));
            const optional = Array.from(document.querySelectorAll('input.feature'));

            const f = foundation.map(cb => ({
                id: cb.dataset.id,
                name: cb.parentElement.textContent.trim(),
                days: toInt(cb.dataset.days),
                cost_million: toInt(cb.dataset.cost),
                type: "foundation",
                selected: true
            }));

            const o = optional.filter(cb => cb.checked).map(cb => ({
                id: cb.dataset.id,
                name: cb.parentElement.textContent.trim(),
                days: toInt(cb.dataset.days),
                cost_million: toInt(cb.dataset.cost),
                type: "optional",
                selected: true
            }));

            const daysF = f.reduce((s, x) => s + x.days, 0);
            const costF = f.reduce((s, x) => s + x.cost_million, 0);
            const daysO = o.reduce((s, x) => s + x.days, 0);
            const costO = o.reduce((s, x) => s + x.cost_million, 0);

            return {
                totals: {
                    foundation_days: daysF,
                    foundation_cost_million: costF,
                    optional_days: daysO,
                    optional_cost_million: costO,
                    grand_days: daysF + daysO,
                    grand_cost_million: costF + costO
                },
                items: f.concat(o)
            };
        }

        function downloadJSON(data, filename) {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }
        function checkAllOptional() {
            document.querySelectorAll('input.feature').forEach(cb => cb.checked = true);
            calcTotals();
        }
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderSections();
            calcTotals();

            // وقتی سکشن‌ها رندر شدن، روی چک‌باکس‌های آپشنال لیسنر بزنیم
            document.querySelectorAll('input.feature').forEach(cb => {
                cb.addEventListener('change', calcTotals);
            });

            // دکمه انتخاب همه آپشنال‌ها
            const btnCheckAll = document.getElementById('btnCheckAll');
            if (btnCheckAll) {
                btnCheckAll.addEventListener('click', () => {
                    checkAllOptional();
                });
            }

            // این دکمه‌ها ممکنه در صفحه نباشن، پس فقط اگر بودن لیسنر بدیم
            const btnExport = document.getElementById('btnExport');
            if (btnExport) {
                btnExport.addEventListener('click', () => {
                    const data = buildJSON();
                    const out = document.getElementById('jsonOutput');
                    if (out) {
                        out.value = JSON.stringify(data, null, 2);
                    }
                    downloadJSON(data, "selection.json");
                });
            }

            const btnReset = document.getElementById('btnReset');
            if (btnReset) {
                btnReset.addEventListener('click', () => {
                    document.querySelectorAll('input.feature').forEach(cb => cb.checked = false);
                    calcTotals();
                    const out = document.getElementById('jsonOutput');
                    if (out) {
                        out.value = "";
                    }
                });
            }

            const btnPrint = document.getElementById('btnPrint');
            if (btnPrint) {
                btnPrint.addEventListener('click', () => window.print());
            }
        });



    </script>
</body>

</html>